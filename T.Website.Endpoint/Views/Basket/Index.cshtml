@model T.Application.Dtos.Baskets.BasketDto
<!-- ================================
    START BREADCRUMB AREA
================================= -->
<section class="breadcrumb-area bread-bg-10">
    <div class="breadcrumb-wrap">
        <div class="container">
            <div class="row">
                <div class="col-lg-12">
                    <div class="breadcrumb-content text-center">
                        <div class="section-heading">
                            <h2 class="sec__title text-white">سبد خرید</h2>
                        </div>
                        <span class="arrow-blink">
                            <i class="la la-arrow-down"></i>
                        </span>
                    </div><!-- end breadcrumb-content -->
                </div><!-- end col-lg-12 -->
            </div><!-- end row -->
        </div><!-- end container -->
    </div><!-- end breadcrumb-wrap -->
    <div class="bread-svg-box">
        <svg class="bread-svg" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 10" preserveAspectRatio="none">
            <polygon points="100 0 50 10 0 0 0 10 100 10"></polygon>
        </svg>
    </div><!-- end bread-svg -->
</section><!-- end breadcrumb-area -->
<!-- ================================
    END BREADCRUMB AREA
================================= -->

<!-- ================================
    START CART AREA
================================= -->
<section class="cart-area section-padding">
    <div class="container">
        <div class="row">
            <div class="col-lg-12">
                <div class="cart-wrap">
                    <div class="table-form table-responsive mb-3">
                        <table class="table" id="listTable">
                            <thead>
                                <tr>
                                    <th scope="col">محصول</th>
                                    <th scope="col">قیمت</th>
                                    <th scope="col">تعداد</th>
                                    <th scope="col">درصد تخفیف</th>
                                    <th scope="col">جمع</th>
                                    <th scope="col">عملیات</th>
                                </tr>
                            </thead>
                            <tbody>
                                @foreach (var item in Model.BasketItems)
                                {
                                    <tr>
                                    <th scope="row">
                                        <div class="table-content product-content d-flex align-items-center">
                                            <a href="room-details.html" class="d-block">
                                                <img src="@item.ImageSrc" alt="" class="flex-shrink-0">
                                            </a>
                                            <div class="product-content">
                                                <a asp-action="RoomDetails" asp-controller="Hotel"
                                                    asp-route-hotelSlug="@item.HotelSlug" asp-route-roomSlug="@item.Slug"
                                                    class="title">@item.RoomName</a>
                                                <div class="product-info-wrap">
                                                    <div class="product-info line-height-24">
                                                        <span class="product-info-label">رزرو : </span>
                                                        <span class="product-info-value">
                                                            <span class="product-check-in">@item.CheckInDate</span>
                                                            <span class="product-mark">/</span>
                                                            <span class="product-check-out">@item.CheckOutDate</span>
                                                            <span class="product-nights">(@item.Days شب)</span>
                                                        </span>
                                                    </div><!-- end product-info -->
                                                    <div class="product-info line-height-24">
                                                        <span class="product-info-label">تعداد تخت : </span>
                                                        <span class="product-info-value">@item.BedNumber</span>
                                                    </div><!-- end product-info -->
                                                </div>
                                            </div>
                                        </div>
                                    </th>
                                    <td>@item.UnitPrice.ToString("n0") تومان </td>
                                    <td>@item.Quantity</td>
                                    <td>@item.DiscountPercent %</td>
                                    <td>@item.TotalPriceWithDiscount تومان</td>
                                    <td>
                                        <div class="remove-wrap">
                                            <button onclick="RemoveItem(@item.Id)" class="btn font-size-18"><i
                                                    class="la la-times"></i></button>
                                        </div>
                                    </td>
                                </tr>
                                }
                            </tbody>
                        </table>
                    </div>
                    <div class="section-block"></div>
                    <div class="cart-actions d-flex justify-content-between align-items-center pt-4 pb-5">
                        <div class="contact-form-action">
                            <form method="post" class="d-flex align-items-center">
                                <div class="form-group mb-0 mr-3">
                                    <input class="form-control pl-3" type="text" name="text" placeholder="کد تخفیف">
                                </div>
                                <button type="button" class="theme-btn">اعمال کد</button>
                            </form>
                        </div><!-- end contact-form-action -->
                        <div class="btn-box">
                            <a href="#" class="theme-btn">به روز رسانی سبد خرید</a>
                        </div>
                    </div>
                    <div class="row">
                        <div class="col-lg-4 ml-auto">
                            <div class="cart-totals table-form">
                                <table class="table">
                                    <thead>
                                        <tr>
                                            <th scope="col">عنوان</th>
                                            <th scope="col">قیمت</th>
                                        </tr>
                                    </thead>
                                    <tbody>
                                        <tr>
                                            <th scope="row">
                                                <div class="table-content">
                                                    <h3 class="title">جمع</h3>
                                                </div>
                                            </th>
                                            <td>110,000 تومان </td>
                                        </tr>
                                        <tr>
                                            <th scope="row">
                                                <div class="table-content">
                                                    <h3 class="title">جمع کل</h3>
                                                </div>
                                            </th>
                                            <td>110,000 تومان </td>
                                        </tr>
                                    </tbody>
                                </table>
                                <div class="section-block"></div>
                                <div class="btn-box text-right pt-4">
                                    <a href="checkout.html" class="theme-btn">به صفحه پرداخت برو</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div><!-- end cart-wrap -->
            </div><!-- end col-lg-12 -->
        </div><!-- end row -->
    </div><!-- end container -->
</section><!-- end cart-area -->
<!-- ================================
    END CART AREA
================================= -->
@section Css
{
<link rel="stylesheet" href="~/css/toastr.min.css">

}
@section Scripts
{
    <script src="~/js/sweetalert2.all.min.js"></script>
<script src="~/js/toastr.min.js"></script>
}
<script>
    
function RemoveItem(id, action) {
    Swal.fire({
        title: "آیا از حذف این آیتم مطمئن هستید ؟",
        text: "در صورت حذف این آیتم از سبد خرید شما حذف می شود !",
        icon: 'question',
        showCancelButton: true,
        confirmButtonColor: '#3085d6',
        cancelButtonColor: '#d33',
        confirmButtonText: 'بله',
        cancelButtonText: 'لغو'
    }).then((result) => {
        if (result.isConfirmed) {
            $.ajax({
                url: `/Basket/DeleteItem?id=${id}`,
                type: "post"
                , success: function (response) {
                    if (response.status === "success") {
                        toastr["success"]("آیتم با موفقیت از سبد شما حذف شد !")
                        toastr.options = {
                            "closeButton": false,
                            "debug": false,
                            "newestOnTop": false,
                            "progressBar": false,
                            "positionClass": "toast-bottom-right",
                            "preventDuplicates": false,
                            "onclick": null,
                            "showDuration": "300",
                            "hideDuration": "1000",
                            "timeOut": "5000",
                            "extendedTimeOut": "1000",
                            "showEasing": "swing",
                            "hideEasing": "linear",
                            "showMethod": "fadeIn",
                            "hideMethod": "fadeOut"
                        }

                        $("#listTable").load(`${location.href} #listTable`);
                    }
                    else {
                        toastr["error"]("عملیات نا موفق !")
                        toastr.options = {
                            "closeButton": false,
                            "debug": false,
                            "newestOnTop": false,
                            "progressBar": false,
                            "positionClass": "toast-bottom-right",
                            "preventDuplicates": false,
                            "onclick": null,
                            "showDuration": "300",
                            "hideDuration": "1000",
                            "timeOut": "5000",
                            "extendedTimeOut": "1000",
                            "showEasing": "swing",
                            "hideEasing": "linear",
                            "showMethod": "fadeIn",
                            "hideMethod": "fadeOut"
                        }
                    }

                },
            });
        }
    })
}
</script>